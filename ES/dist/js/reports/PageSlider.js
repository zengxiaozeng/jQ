"use strict";!function(d,e){var s,a,r,o,h,c,i={direction:"vertical",currentClass:"current",gestureFollowing:!1,hasDot:!1,rememberLastVisited:!1,preventDefault:!0,animationPlayOnce:!1,dev:!1,onSwipeUp:function(){},onSwipeDown:function(){},onSwipeLeft:function(){},onSwipeRight:function(){},oninit:function(){},onbeforechange:function(){},onchange:function(){}},n=document.documentElement.clientWidth,l=document.documentElement.clientHeight,u="end";function g(t){if(d.extend(this,i,t),this.pages.length<=0)throw new Error("target para not pass");this.target=this.pages.eq(0).parent(),this.length=this.pages.length,this.moveTo=g.prototype.moveTo,this.index=0,this.curPage=this.pages.eq(this.index),this.timer=null,o=this.gestureFollowing,"vertical"!==this.direction&&"v"!==this.direction||(this.direction="v"),"horizontal"!==this.direction&&"h"!==this.direction||(this.direction="h"),this.length<=1||this._init()}g.prototype={_init:function(){var e=this;this.target.css("-webkit-transition","-webkit-transform 0.5s ease"),this.pages.each(function(){var t=d(this),e=t.wrapInner('<div class="PageSlider__wraper"></div>').find(".PageSlider__wraper"),i=e.height();l<i&&(t.data("height",i),t.css("overflow","auto")),e.children().unwrap()}),"h"===this.direction&&(this.target.css("position","relative"),this.pages.each(function(t){d(this).css({position:"absolute",left:100*t+"%",top:0})})),this.hasDot&&this._createDot(),e._bindAnimation(),this.target.on("touchstart",function(t){e._startHandle(t)}),this.target.on("touchmove",function(t){e._moveHandle(t)}),this.target.on("touchend",function(t){e._endHandle(t)}),this.rememberLastVisited&&(this.lastVisitedIndex=this._getLastVisited()),this.target.css("-webkit-transform","translate(0, 0)"),this.pages.eq(0).addClass(this.currentClass),this.oninit.call(this),this._dev()},_startHandle:function(t){var e=t.touches[0];s=this.curPage.data("lock-next"),a=this.curPage.data("lock-prev"),"running"!==u?(r="v"===this.direction?e.clientY:e.clientX,this.curPage[0].pageScrollHeight=this.curPage.data("height"),this.curPage[0].pageScrollHeight&&(o&&(this.gestureFollowing=!1),this.preventDefault=!1,c=l+this.curPage.scrollTop()),this.gestureFollowing&&(h=-this.index*("v"===this.direction?l:n))):t.preventDefault()},_moveHandle:function(t){var e,i,n=t.changedTouches[0];"running"!==u?(e=(i="v"===this.direction?n.clientY:n.clientX)-r,this.curPage[0].pageScrollHeight&&(0<e&&c===l&&t.preventDefault(),e<0&&c===this.curPage[0].pageScrollHeight&&t.preventDefault()),this.gestureFollowing?this.index<=0&&r<i||this.index>=this.length-1&&i<r?t.preventDefault():0<e&&a||e<0&&s?t.preventDefault():(e=h+e+"px",this._removeTransition(),"v"===this.direction?this.target.css("-webkit-transform","translate(0, "+e+")"):this.target.css("-webkit-transform","translate("+e+", 0)"),this._preventDefault(t)):this._preventDefault(t)):t.preventDefault()},_endHandle:function(t){var e,i=t.changedTouches[0];if("running"!==u){if(e=("v"===this.direction?i.clientY:i.clientX)-r,this._setTransition(),0<e&&("v"===this.direction?this.onSwipeDown.call(this):this.onSwipeRight.call(this),!a)){if(this.curPage[0].pageScrollHeight&&l<c)return;20<e?this.prev():this.moveTo(this.index)}if(e<0&&("v"===this.direction?this.onSwipeUp.call(this):this.onSwipeLeft.call(this),!s)){if(this.curPage[0].pageScrollHeight&&c<this.curPage[0].pageScrollHeight)return;e<-20?this.next():this.moveTo(this.index)}}else t.preventDefault()},moveTo:function(t,e){var i,n=this;u="running",e=e||!1,(t=parseInt(t))>=this.length||t<0?u="end":(e&&this._removeTransition(),this.onbeforechange.call(this),"v"===this.direction&&(i=100*-t+"%",this.target.css("-webkit-transform","translate(0, "+i+")")),"h"===this.direction&&(i=100*-t+"%",this.target.css("-webkit-transform","translate("+i+", 0)")),clearTimeout(this.timer),this.timer=setTimeout(function(){n._currentClass(t),n.prevIndex=n.index,n.index=t,n.onchange.call(n),e&&n._setTransition(),n.curPage&&n.curPage[0].pageScrollHeight&&(o&&(n.gestureFollowing=!0),n.preventDefault=!0,n.curPage.scrollTop(0)),n.curPage=n.pages.eq(n.index),n.rememberLastVisited&&n._saveLastVisited(),u="end",clearTimeout(n.timer)},500))},prev:function(){this.moveTo(this.index-1)},next:function(){this.moveTo(this.index+1)},_setTransition:function(){this.target.css("-webkit-transition","-webkit-transform 0.5s ease")},_removeTransition:function(){this.target.css("-webkit-transition","none")},_currentClass:function(t){var e=this.currentClass;this.pages.eq(t).addClass(e),t===this.index||this.animationPlayOnce||this.pages.eq(this.index).removeClass(e)},_createDot:function(){for(var t="",e=0;e<this.length;e++)t+="<li>"+(e+1)+"</li>";d(t).appendTo(this.target).wrapAll('<ul class="dot-list">')},_saveLastVisited:function(){var t=e.localStorage;t&&t.setItem("pageSliderIndex",this.index)},_getLastVisited:function(){var t=e.localStorage;if(t)return this.cacheIndex=t.getItem("pageSliderIndex"),parseInt(this.cacheIndex)},_bindAnimation:function(){var c=this,l="<style>";d("[data-animation]").each(function(t){var e=d(this),i=e.data("animation"),n=i.name,s=i.duration||500,a=i.delay||0,r=i["timing-function"]||"ease",o=i["fill-mode"]||"both",h=i["iteration-count"]||1;e.data("animationid",++t),l+="."+c.currentClass+' [data-animationid="'+t+'"]{-webkit-animation-name: '+n+";-webkit-animation-duration: "+s+"ms;-webkit-animation-delay: "+a+"ms;-webkit-animation-timing-function: "+r+";-webkit-animation-fill-mode: "+o+";-webkit-animation-iteration-count: "+h+";}"}),d("head").eq(0).append(l)},_preventDefault:function(t){this.preventDefault&&t.preventDefault()},_dev:function(){!1!==this.dev&&this.moveTo(this.dev,!0)}},e.PageSlider=g}(Zepto,window),"function"==typeof define&&define.amd&&define("PageSlider",[],function(){return PageSlider});